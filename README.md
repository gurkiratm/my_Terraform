# learning-terraform

[Terraform Documentation](https://developer.hashicorp.com/terraform/tutorials/aws-get-started/aws-create)

## Commands
```bash
terraform fmt
terraform init
terraform validate
terraform plan
terraform apply
terraform state
terraform show
```

## The terraform block
- The `terraform {}` block configures Terraform itself, including which providers to install, and which version of Terraform to use to provision your infrastructure. 
- Terraform uses binary plugins called `providers` to manage your resources by calling your cloud provider's APIs.
- Terraform providers are distributed and versioned separately from Terraform. By decoupling providers from the Terraform binary, Terraform can support any infrastructure vendor with an API. 

## Configuration blocks
- When you write a new Terraform configuration, we recommend defining your provider blocks and other primary infrastructure in `main.tf` as a best practice. 
### Providers
- <ins>You can use multiple provider blocks in your Terraform configuration to configure multiple providers or multiple instances of the same provider with different configurations, such as a different region.</ins>
- Terraform's AWS provider uses the same authentication methods as the AWS CLI. If you have not already done so, configure your AWS credentials as environment variables in your terminal.
### Data sources
- use `data` blocks to query your cloud provider for information about other resources.
- Data sources help keep your configuration dynamic and avoid hardcoded values that can become stale.
- Data sources have an ID, which you can use to reference the data attributes within your configuration.
- Data source IDs are prefixed with data, followed by the block's type and name.
### Resources
- A `resource` block defines a component of your infrastructure.
- Provider developers determine supported resources types and their arguments. The first line of a resource block declares a resource type and resource name.
- The prefix of the resource type corresponds to the name of the provider, and the rest of the string is the provider-defined resource type.
- Together, the resource type and resource name form a unique resource address for the resource in your configuration.

## Format configuration
- The terraform fmt command automatically reformats all configuration files in the current directory according to HashiCorp's recommended style.
```bash
$ terraform fmt
main.tf
```
- Terraform prints the names of the files it modified, if any.

## Initialize your workspace
- Before you can apply your configuration, you must initialize your Terraform workspace with the `terraform init` command.
- As part of initialization, Terraform downloads and installs the providers defined in your configuration in your current working directory.
```bash
$ terraform init
```
- Terraform downloaded the `aws` provider and installed it in a hidden `.terraform` subdirectory of your current working directory.
- Terraform also created a file named `.terraform.lock.hcl` which specifies the exact provider versions used with your workspace, ensuring consistency between runs.

## Validate configuration
Make sure your configuration is syntactically valid and internally consistent by using the terraform validate command.
```bash
terraform validate
```
The `validate` command helps you identify errors in your configuration. For example, if you mistype a resource name or refer to an argument your resource does not support, Terraform will report an error when you validate your configuration.

## Create infrastructure
Terraform makes changes to your infrastructure in two steps.

Terraform creates an **execution plan** for the changes it will make. Review this plan to ensure that Terraform will make the changes you expect.

Once you approve the execution plan, Terraform applies those changes using your workspace's providers.

This workflow ensures that you can detect and resolve any unexpected problems with your configuration before Terraform makes changes to your infrastructure.

Plan and apply your configuration now with the `terraform apply` command. Terraform will print out the execution plan and ask you to confirm the changes before it applies them. 

The output format is similar to the diff format generated by tools such as Git.

## Inspect state
When you applied your configuration, Terraform wrote data about your infrastructure into a file called `terraform.tfstate`. Terraform stores data about your infrastructure in its state file, which it uses to manage resources over their lifecycle.

List the resources and data sources in your Terraform workspace's state with the `terraform state` list command.

Even though the data source is not an actual resource, Terraform tracks it in your state file. Print out your workspace's entire state using the `terraform show` command.

When you use Terraform to plan and apply changes to your workspace's infrastructure, Terraform compares the last known state in your state file, your current configuration, and data returned by your providers to create its execution plan.